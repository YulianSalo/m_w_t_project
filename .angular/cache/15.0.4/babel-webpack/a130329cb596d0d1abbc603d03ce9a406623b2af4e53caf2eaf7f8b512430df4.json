{"ast":null,"code":"import { Conn } from '../conn';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../accounts.service\";\nimport * as i2 from \"@angular/common/http\";\nfunction AddsubcatComponent_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const x_r2 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", x_r2._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(x_r2.categoryname);\n  }\n}\nconst _c0 = function () {\n  return [\"/updatesubcat\"];\n};\nconst _c1 = function (a0) {\n  return {\n    subcatid: a0\n  };\n};\nfunction AddsubcatComponent_div_17_tr_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵelement(4, \"img\", 18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"button\", 19);\n    i0.ɵɵtext(9, \"Update\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"td\")(11, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function AddsubcatComponent_div_17_tr_20_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const x_r4 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.scatdelete(x_r4._id));\n    });\n    i0.ɵɵtext(12, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const x_r4 = ctx.$implicit;\n    const i_r5 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r5 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"uploads/\", x_r4.subcatpic, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(x_r4.subcatname);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0))(\"queryParams\", i0.ɵɵpureFunction1(6, _c1, x_r4._id));\n  }\n}\nfunction AddsubcatComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 1)(2, \"h3\", 14);\n    i0.ɵɵtext(3, \"Existing Sub categories \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\")(5, \"br\");\n    i0.ɵɵelementStart(6, \"div\", 15)(7, \"table\", 16)(8, \"thead\")(9, \"tr\")(10, \"th\");\n    i0.ɵɵtext(11, \"SL No.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Picture\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Update\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\");\n    i0.ɵɵtext(19, \"Delete\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(20, AddsubcatComponent_div_17_tr_20_Template, 13, 8, \"tr\", 17);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(20);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.allsubcatlist);\n  }\n}\nexport let AddsubcatComponent = /*#__PURE__*/(() => {\n  class AddsubcatComponent {\n    constructor(catsrvobj, myhttp) {\n      this.catsrvobj = catsrvobj;\n      this.myhttp = myhttp;\n      this.category = \"\";\n      this.flag = false;\n    }\n    ngOnInit() {\n      this.scatname = \"\";\n      this.category = \"\";\n      this.flag = false;\n      this.fetchcat();\n    }\n    fileselected(event) {\n      this.myfile = event.target.files[0];\n      console.log(event);\n    }\n    addsubcat() {\n      $(\"#mssg\").fadeIn(1000).fadeOut(1000);\n      var mydata = new FormData();\n      mydata.append(\"catname\", this.category);\n      mydata.append(\"subcatname\", this.scatname);\n      mydata.append(\"subcatpic\", this.myfile);\n      this.catsrvobj.savescat2db(mydata).subscribe({\n        next: res => {\n          this.msg = res;\n          setTimeout(() => {\n            this.ngOnInit();\n          }, 1500);\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    fetchcat() {\n      this.catsrvobj.fetchallcat().subscribe({\n        next: res => {\n          this.allcatlist = res;\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    fetchsubcatbycatid() {\n      this.catsrvobj.fetchsubcatbycatid(this.category).subscribe({\n        next: res => {\n          if (res.length > 0) {\n            this.flag = true;\n            this.allsubcatlist = res;\n            this.msg = null;\n          } else {\n            this.flag = false;\n            this.msg = \"No sub categories to display\";\n          }\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    scatdelete(scatid) {\n      // alert(catid);\n      var confrm = confirm(\"Are you sure want to delete?\");\n      if (confrm) {\n        //note that we get a json object only as a response and not an array of objects\n        this.myhttp.delete(Conn.nodeurl + \"/delsubcat?subcatid=\" + scatid, {\n          responseType: \"json\"\n        }).subscribe({\n          next: res => {\n            if (res[\"deletedCount\"] == 1) {\n              alert(\"Sub Category Deleted Successfully!\");\n              this.ngOnInit();\n              //this was the best part of todays lecture used to refresh the componenet\n            }\n          },\n\n          error: err => {\n            this.msg = err;\n          }\n        });\n      }\n    }\n  }\n  AddsubcatComponent.ɵfac = function AddsubcatComponent_Factory(t) {\n    return new (t || AddsubcatComponent)(i0.ɵɵdirectiveInject(i1.AccountsService), i0.ɵɵdirectiveInject(i2.HttpClient));\n  };\n  AddsubcatComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddsubcatComponent,\n    selectors: [[\"app-addsubcat\"]],\n    decls: 18,\n    vars: 5,\n    consts: [[1, \"login\"], [1, \"container\"], [\"data-wow-delay\", \".5s\", 1, \"login-form-grids\", \"animated\", \"wow\", \"slideInUp\"], [\"enctype\", \"multipart/form-data\"], [\"name\", \"category\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"text\", \"name\", \"scatname\", \"placeholder\", \"Sub Category Name\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"file\", \"name\", \"scatpic\", 3, \"change\"], [\"type\", \"submit\", \"name\", \"b2\", \"value\", \"Add\", 3, \"click\"], [\"id\", \"mssg\"], [\"class\", \"checkout\", 4, \"ngIf\"], [3, \"value\"], [1, \"checkout\"], [1, \"w3_agile_header\"], [1, \"table\"], [1, \"timetable_sub\"], [4, \"ngFor\", \"ngForOf\"], [\"height\", \"75\", 3, \"src\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"routerLink\", \"queryParams\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"]],\n    template: function AddsubcatComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n        i0.ɵɵtext(3, \"Add Sub Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"form\", 3)(6, \"select\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function AddsubcatComponent_Template_select_ngModelChange_6_listener($event) {\n          return ctx.category = $event;\n        })(\"change\", function AddsubcatComponent_Template_select_change_6_listener() {\n          return ctx.fetchsubcatbycatid();\n        });\n        i0.ɵɵelementStart(7, \"option\", 5);\n        i0.ɵɵtext(8, \"Choose Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(9, AddsubcatComponent_option_9_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function AddsubcatComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.scatname = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"br\");\n        i0.ɵɵelementStart(12, \"input\", 8);\n        i0.ɵɵlistener(\"change\", function AddsubcatComponent_Template_input_change_12_listener($event) {\n          return ctx.fileselected($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"input\", 9);\n        i0.ɵɵlistener(\"click\", function AddsubcatComponent_Template_input_click_13_listener() {\n          return ctx.addsubcat();\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(14, \"br\");\n        i0.ɵɵelementStart(15, \"p\", 10);\n        i0.ɵɵtext(16);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(17, AddsubcatComponent_div_17_Template, 21, 1, \"div\", 11);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.category);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.allcatlist);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.scatname);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.msg);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.flag);\n      }\n    },\n    styles: [\".table[_ngcontent-%COMP%]{overflow:scroll}\"]\n  });\n  return AddsubcatComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}