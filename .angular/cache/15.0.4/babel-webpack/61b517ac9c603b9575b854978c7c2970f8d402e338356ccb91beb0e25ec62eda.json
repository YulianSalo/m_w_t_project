{"ast":null,"code":"import { Conn } from '../conn';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../accounts.service\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/forms\";\nfunction ManageproductComponent_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const x_r3 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", x_r3._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(x_r3.categoryname);\n  }\n}\nfunction ManageproductComponent_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const x_r4 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", x_r4._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(x_r4.subcatname);\n  }\n}\nconst _c0 = function () {\n  return [\"/updateprod\"];\n};\nconst _c1 = function (a0) {\n  return {\n    prodid: a0\n  };\n};\nfunction ManageproductComponent_div_31_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵelement(4, \"img\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"button\", 23);\n    i0.ɵɵtext(9, \"Update\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"td\")(11, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ManageproductComponent_div_31_tr_19_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r9);\n      const x_r6 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.proddelete(x_r6._id));\n    });\n    i0.ɵɵtext(12, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const x_r6 = ctx.$implicit;\n    const i_r7 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r7 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"src\", \"uploads/\", x_r6.prodpic, \"\", i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(x_r6.product);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0))(\"queryParams\", i0.ɵɵpureFunction1(6, _c1, x_r6._id));\n  }\n}\nfunction ManageproductComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"div\", 1)(2, \"h3\", 19);\n    i0.ɵɵtext(3, \"Existing Products \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"br\")(5, \"br\");\n    i0.ɵɵelementStart(6, \"table\", 20)(7, \"thead\")(8, \"tr\")(9, \"th\");\n    i0.ɵɵtext(10, \"SL No.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12, \"Picture\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\");\n    i0.ɵɵtext(16, \"Update\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"th\");\n    i0.ɵɵtext(18, \"Delete\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵtemplate(19, ManageproductComponent_div_31_tr_19_Template, 13, 8, \"tr\", 21);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(19);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.allprodlist);\n  }\n}\nexport let ManageproductComponent = /*#__PURE__*/(() => {\n  class ManageproductComponent {\n    constructor(catsrvobj, myhttp) {\n      this.catsrvobj = catsrvobj;\n      this.myhttp = myhttp;\n      this.category = \"\";\n      this.subcat = \"\";\n      this.matchedsubcatlist = [];\n      this.flag = false;\n    }\n    ngOnInit() {\n      this.fetchcat();\n      this.flag = false;\n      this.category = \"\";\n      this.subcat = \"\";\n      this.prodname = \"\";\n      this.rate = \"\";\n      this.disc = \"\";\n      this.stock = \"\";\n      this.description = \"\";\n      // this.fetchsubcat();\n    }\n\n    fileselected(event) {\n      this.myfile = event.target.files[0];\n      console.log(event);\n    }\n    addproduct() {\n      $(\"#mssg\").fadeIn(1000).fadeOut(2500);\n      var mydata = new FormData();\n      mydata.append(\"catname\", this.category);\n      mydata.append(\"subcatname\", this.subcat);\n      mydata.append(\"prodname\", this.prodname);\n      mydata.append(\"rate\", this.rate);\n      mydata.append(\"disc\", this.disc);\n      mydata.append(\"stock\", this.stock);\n      mydata.append(\"description\", this.description);\n      mydata.append(\"prodpic\", this.myfile);\n      this.catsrvobj.saveprod2db(mydata).subscribe({\n        next: res => {\n          this.msg = res;\n          setTimeout(() => {\n            this.ngOnInit();\n          }, 1500);\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    fetchcat() {\n      this.catsrvobj.fetchallcat().subscribe({\n        next: res => {\n          this.allcatlist = res;\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    // fetchsubcat()\n    // {\n    //   this.catsrvobj.fetchsubcat(scid).subscribe({\n    //     next:(res:any[])=>{\n    //       this.allsubcatlist= res;\n    //     },\n    //     error:(err)=>{\n    //       this.msg=err;\n    //     }\n    //   })\n    // }\n    fetchsubcatbycatid() {\n      this.catsrvobj.fetchsubcatbycatid(this.category).subscribe({\n        next: res => {\n          this.allsubcatlist = res;\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    showsubcat() {\n      //to clear previous category\n      this.matchedsubcatlist.splice(0, this.matchedsubcatlist.length);\n      for (let i = 0; i < this.allsubcatlist.length; i++) {\n        if (this.category == this.allsubcatlist[i].category) {\n          this.matchedsubcatlist.push(this.allsubcatlist[i]);\n        }\n      }\n    }\n    fetchprodbyscid() {\n      this.catsrvobj.fetchprodbyscid(this.subcat).subscribe({\n        next: res => {\n          if (res.length > 0) {\n            this.allprodlist = res;\n            this.flag = true;\n            this.msg = null;\n          } else {\n            this.flag = false;\n            this.msg = \"No Products to show\";\n          }\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    proddelete(prodid) {\n      // alert(catid);\n      var confrm = confirm(\"Are you sure want to delete?\");\n      if (confrm) {\n        //note that we get a json object only as a response and not an array of objects\n        this.myhttp.delete(Conn.nodeurl + \"/delprod?prodid=\" + prodid, {\n          responseType: \"json\"\n        }).subscribe({\n          next: res => {\n            if (res[\"deletedCount\"] == 1) {\n              alert(\"Product Deleted Successfully!\");\n              this.ngOnInit();\n              //this was the best part of todays lecture used to refresh the componenet\n            }\n          },\n\n          error: err => {\n            this.msg = err;\n          }\n        });\n      }\n    }\n  }\n  ManageproductComponent.ɵfac = function ManageproductComponent_Factory(t) {\n    return new (t || ManageproductComponent)(i0.ɵɵdirectiveInject(i1.AccountsService), i0.ɵɵdirectiveInject(i2.HttpClient));\n  };\n  ManageproductComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ManageproductComponent,\n    selectors: [[\"app-manageproduct\"]],\n    decls: 32,\n    vars: 11,\n    consts: [[1, \"login\"], [1, \"container\"], [\"data-wow-delay\", \".5s\", 1, \"login-form-grids\", \"animated\", \"wow\", \"slideInUp\"], [\"enctype\", \"multipart/form-data\"], [\"name\", \"category\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"subcat\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"type\", \"text\", \"name\", \"prodname\", \"placeholder\", \"Product Name\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"rate\", \"placeholder\", \"Rate\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"disc\", \"placeholder\", \"Discount in % (But dont add % symbol)\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"text\", \"name\", \"stock\", \"placeholder\", \"Stock\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"description\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"file\", \"name\", \"scatpic\", 3, \"change\"], [\"type\", \"submit\", \"name\", \"b2\", \"value\", \"Add\", 3, \"click\"], [\"id\", \"mssg\"], [\"class\", \"checkout\", 4, \"ngIf\"], [3, \"value\"], [1, \"checkout\"], [1, \"w3_agile_header\"], [1, \"timetable_sub\"], [4, \"ngFor\", \"ngForOf\"], [\"height\", \"75\", 3, \"src\"], [\"type\", \"button\", 1, \"btn\", \"btn-success\", 3, \"routerLink\", \"queryParams\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"click\"]],\n    template: function ManageproductComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n        i0.ɵɵtext(3, \"Add Product\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"form\", 3)(6, \"select\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_select_ngModelChange_6_listener($event) {\n          return ctx.category = $event;\n        })(\"change\", function ManageproductComponent_Template_select_change_6_listener() {\n          return ctx.fetchsubcatbycatid();\n        });\n        i0.ɵɵelementStart(7, \"option\", 5);\n        i0.ɵɵtext(8, \"Choose Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(9, ManageproductComponent_option_9_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(10, \"br\");\n        i0.ɵɵelementStart(11, \"select\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_select_ngModelChange_11_listener($event) {\n          return ctx.subcat = $event;\n        })(\"change\", function ManageproductComponent_Template_select_change_11_listener() {\n          return ctx.fetchprodbyscid();\n        });\n        i0.ɵɵelementStart(12, \"option\", 5);\n        i0.ɵɵtext(13, \"Choose SubCategory\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, ManageproductComponent_option_14_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(15, \"br\");\n        i0.ɵɵelementStart(16, \"input\", 8);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_input_ngModelChange_16_listener($event) {\n          return ctx.prodname = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(17, \"br\");\n        i0.ɵɵelementStart(18, \"input\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_input_ngModelChange_18_listener($event) {\n          return ctx.rate = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(19, \"br\");\n        i0.ɵɵelementStart(20, \"input\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_input_ngModelChange_20_listener($event) {\n          return ctx.disc = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(21, \"br\");\n        i0.ɵɵelementStart(22, \"input\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_input_ngModelChange_22_listener($event) {\n          return ctx.stock = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(23, \"br\");\n        i0.ɵɵelementStart(24, \"textarea\", 12);\n        i0.ɵɵlistener(\"ngModelChange\", function ManageproductComponent_Template_textarea_ngModelChange_24_listener($event) {\n          return ctx.description = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(25, \"br\");\n        i0.ɵɵelementStart(26, \"input\", 13);\n        i0.ɵɵlistener(\"change\", function ManageproductComponent_Template_input_change_26_listener($event) {\n          return ctx.fileselected($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"input\", 14);\n        i0.ɵɵlistener(\"click\", function ManageproductComponent_Template_input_click_27_listener() {\n          return ctx.addproduct();\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(28, \"br\");\n        i0.ɵɵelementStart(29, \"p\", 15);\n        i0.ɵɵtext(30);\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(31, ManageproductComponent_div_31_Template, 20, 1, \"div\", 16);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.category);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.allcatlist);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.subcat);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.allsubcatlist);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.prodname);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.rate);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.disc);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.stock);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.description);\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate(ctx.msg);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.flag);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.RouterLink, i5.ɵNgNoValidate, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.NgModel, i5.NgForm]\n  });\n  return ManageproductComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}