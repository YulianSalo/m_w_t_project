{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../accounts.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction UpdatesubcatComponent_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 11);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const x_r1 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", x_r1._id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(x_r1.categoryname);\n  }\n}\nexport let UpdatesubcatComponent = /*#__PURE__*/(() => {\n  class UpdatesubcatComponent {\n    constructor(catsrvobj, myroute) {\n      this.catsrvobj = catsrvobj;\n      this.myroute = myroute;\n      this.category = \"\";\n      this.myroute.queryParams.subscribe({\n        next: params => {\n          this.scid = params[\"subcatid\"];\n          this.fetchscatdetails();\n        }\n      });\n    }\n    //activated route is used in order to grab the query params\n    ngOnInit() {\n      this.fetchcat();\n    }\n    fileselected(event) {\n      this.myfile = event.target.files[0];\n      console.log(event);\n    }\n    fetchcat() {\n      this.catsrvobj.fetchallcat().subscribe({\n        next: res => {\n          this.allcatlist = res;\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    fetchscatdetails() {\n      this.catsrvobj.fetchsubcatdetailsbyid(this.scid).subscribe({\n        next: resp => {\n          this.category = resp[0].category;\n          this.scatname = resp[0].subcatname;\n          this.subcatimg = resp[0].subcatpic;\n        },\n        error: err => {\n          this.msg = err;\n        }\n      });\n    }\n    updatesubcat() {\n      var mydata = new FormData();\n      if (this.myfile != null)\n        // user has chosen new file\n        {\n          mydata.append(\"cid\", this.category);\n          mydata.append(\"scatname\", this.scatname); //either old/new name\n          mydata.append(\"scatpic\", this.myfile); //new pic\n          mydata.append(\"oldpicname\", this.subcatimg); //sent for deletion\n          mydata.append(\"scid\", this.scid);\n        } else {\n        mydata.append(\"cid\", this.category);\n        mydata.append(\"scatname\", this.scatname);\n        mydata.append(\"oldpicname\", this.subcatimg); //sent for retaining old name\n        mydata.append(\"scid\", this.scid);\n      }\n      this.catsrvobj.updatesubcat(mydata).subscribe({\n        next: res => {\n          if (res['nModified'] == 1) {\n            this.msg = \"Sub Category Updated Successfully\";\n          } else {\n            this.msg = \"Sub Category Not Updated Successfully\";\n          }\n        },\n        error: err => {}\n      });\n    }\n  }\n  UpdatesubcatComponent.ɵfac = function UpdatesubcatComponent_Factory(t) {\n    return new (t || UpdatesubcatComponent)(i0.ɵɵdirectiveInject(i1.AccountsService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n  };\n  UpdatesubcatComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UpdatesubcatComponent,\n    selectors: [[\"app-updatesubcat\"]],\n    decls: 23,\n    vars: 5,\n    consts: [[1, \"login\"], [1, \"container\"], [\"data-wow-delay\", \".5s\", 1, \"login-form-grids\", \"animated\", \"wow\", \"slideInUp\"], [\"enctype\", \"multipart/form-data\"], [\"name\", \"category\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"text\", \"name\", \"scatname\", \"placeholder\", \"Sub Category Name\", 3, \"ngModel\", \"ngModelChange\"], [\"height\", \"75\", 3, \"src\"], [\"type\", \"file\", \"name\", \"scatpic\", 3, \"change\"], [\"type\", \"submit\", \"name\", \"b2\", \"value\", \"Update\", 3, \"click\"], [3, \"value\"]],\n    template: function UpdatesubcatComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n        i0.ɵɵtext(3, \"Manage Sub Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"form\", 3)(6, \"select\", 4);\n        i0.ɵɵlistener(\"ngModelChange\", function UpdatesubcatComponent_Template_select_ngModelChange_6_listener($event) {\n          return ctx.category = $event;\n        });\n        i0.ɵɵelementStart(7, \"option\", 5);\n        i0.ɵɵtext(8, \"Choose Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(9, UpdatesubcatComponent_option_9_Template, 2, 2, \"option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function UpdatesubcatComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.scatname = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"br\")(12, \"img\", 8)(13, \"br\")(14, \"br\");\n        i0.ɵɵtext(15, \" Choose new image, if required\");\n        i0.ɵɵelement(16, \"br\")(17, \"br\");\n        i0.ɵɵelementStart(18, \"input\", 9);\n        i0.ɵɵlistener(\"change\", function UpdatesubcatComponent_Template_input_change_18_listener($event) {\n          return ctx.fileselected($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"input\", 10);\n        i0.ɵɵlistener(\"click\", function UpdatesubcatComponent_Template_input_click_19_listener() {\n          return ctx.updatesubcat();\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(20, \"br\");\n        i0.ɵɵelementStart(21, \"p\");\n        i0.ɵɵtext(22);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.category);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.allcatlist);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngModel\", ctx.scatname);\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate1(\"src\", \"uploads/\", ctx.subcatimg, \"\", i0.ɵɵsanitizeUrl);\n        i0.ɵɵadvance(10);\n        i0.ɵɵtextInterpolate(ctx.msg);\n      }\n    },\n    dependencies: [i3.NgForOf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.NgModel, i4.NgForm]\n  });\n  return UpdatesubcatComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}